# SSH BBS 프로젝트 명세서 (SPEC.md)

이 문서는 SSH 기반의 게시판 시스템(BBS)인 `ssh_bbs` 프로젝트의 기술 명세서입니다. 이 문서는 LLM 모델이 프로젝트의 구조와 기능을 이해하고 효과적으로 구현/유지보수할 수 있도록 작성되었습니다.

## 1. 프로젝트 개요
*   **이름:** SSH BBS
*   **목적:** 터미널 환경에서 SSH 접속을 통해 접근 가능한 텍스트 기반 게시판 커뮤니티 시스템 구축.
*   **핵심 가치:** 레트로 감성, 터미널 친화적 UI, 키보드 중심의 효율적인 UX.

## 2. 기술 스택
*   **언어:** Go (Golang)
*   **TUI 프레임워크:** [Bubbletea](github.com/charmbracelet/bubbletea) (The Elm Architecture 기반)
*   **SSH 서버:** [Wish](github.com/charmbracelet/wish)
*   **스타일링:** [Lipgloss](github.com/charmbracelet/lipgloss)
*   **마크다운 렌더링:** [Glamour](github.com/charmbracelet/glamour)
*   **데이터 저장:** JSON 파일 시스템 (로컬 파일 기반 영속성)

## 3. 아키텍처
프로젝트는 **Model-View-Update (MVU)** 패턴을 따릅니다.

### 3.1 디렉토리 구조
*   `cmd/bbs/`: 메인 엔트리 포인트. SSH 서버 초기화 및 실행.
*   `internal/bbs/`: 핵심 비즈니스 로직 및 데이터 모델 (Board, Post, Comment).
*   `internal/ui/`: TUI 구현 (Model, View, Update, Styles).
*   `data/`: 데이터 저장소 (JSON 파일).

### 3.2 데이터 모델 (`internal/bbs`)
*   **BBS:** 전체 게시판 시스템 관리.
*   **Board:** 개별 게시판 (예: General, Tech).
*   **Post:** 게시글.
    *   필드: `ID`, `Title`, `Content`, `Author`, `CreatedAt`, `Comments`.
*   **Comment:** 댓글.
    *   필드: `ID`, `PostID`, `ParentID` (대댓글 지원), `Author`, `Content`, `CreatedAt`.

## 4. 주요 기능 및 UX 명세

### 4.1 공통 UI/UX
*   **네비게이션:** Vim 스타일 키 바인딩 (`j`/`k`: 이동, `h`/`l`: 뒤로/선택) 지원.
*   **스타일:** Lipgloss를 활용한 컬러풀하고 현대적인 TUI 디자인 (보더, 패딩, 색상 활용).
*   **반응형:** 터미널 크기에 따른 동적 레이아웃 조정.

### 4.2 화면별 기능

#### A. 게시판 목록 (`viewBoards`)
*   **기능:** 사용 가능한 게시판 목록 표시.
*   **키 바인딩:**
    *   `j` / `down`: 아래로 이동
    *   `k` / `up`: 위로 이동
    *   `enter` / `l` / `right`: 게시판 선택
    *   `q`: 종료

#### B. 게시글 목록 (`viewPosts`)
*   **기능:** 선택된 게시판의 게시글 목록 표시 (페이지네이션, 검색).
*   **UI:** 테이블 형태 (ID, Title, Author, Date).
*   **페이지네이션:** 한 페이지당 10개 항목 표시.
    *   `n`: 다음 페이지
    *   `p`: 이전 페이지
*   **검색:**
    *   `/`: 검색 모드 진입 (제목/내용 검색)
    *   `esc`: 검색 취소/초기화
*   **작성:**
    *   `w`: 새 글 작성 (`viewCompose`로 전환)
*   **이동 제한:** 스크롤 시 현재 페이지 범위를 벗어나지 않음.

#### C. 게시글 상세 (`viewPost`)
*   **기능:** 게시글 내용 및 댓글 표시.
*   **UI:**
    *   전체 화면 뷰포트 사용.
    *   마크다운 렌더링 지원.
    *   상단: 게시글 메타데이터 및 본문.
    *   하단: 댓글 리스트 (대댓글 들여쓰기 표시).
*   **키 바인딩:**
    *   `j` / `k`: 본문 스크롤
    *   `r`: 댓글 작성 (Reply)
    *   `c`: 댓글 리스트 최상단으로 이동 (Focus)
    *   `d`: 게시글 삭제 (본인 글인 경우)
    *   `b` / `esc` / `left`: 목록으로 복귀

#### D. 글/댓글 작성 (`viewCompose`)
*   **기능:** 새 게시글 또는 댓글 작성.
*   **UI:** 제목(게시글인 경우) 및 내용 입력 폼.
*   **키 바인딩:**
    *   `tab`: 입력 필드 전환
    *   `ctrl+s`: 저장 및 게시
    *   `esc`: 취소

#### E. 댓글 목록 (`viewComments`)
*   **기능:** (현재 `viewPost`에 통합됨, 별도 화면으로 존재하나 주로 상세 뷰에서 인라인으로 처리).
*   **UI:** 테이블 형태, 대댓글 계층 구조 시각화 (`>` 접두사).
*   **스크롤:** 뷰포트를 사용하여 긴 댓글 목록도 겹침 없이 스크롤 가능.

## 5. 데이터 영속성
*   `data/posts/` 디렉토리에 게시판별 JSON 파일로 저장.
*   서버 재시작 시 파일에서 데이터를 로드하여 상태 복원.

## 6. 향후 확장 고려 사항
*   **사용자 인증:** 현재는 SSH 접속자명을 그대로 사용하나, 향후 키 기반 인증 또는 별도 가입 절차 고려.
*   **실시간 업데이트:** 다른 사용자의 글/댓글 실시간 반영 (Bubbletea command/subscription 활용).
*   **관리자 기능:** 게시판 생성/삭제, 타인 글 관리 등.
